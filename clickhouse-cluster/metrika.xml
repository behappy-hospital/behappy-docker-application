<!--所有实例均使用这个集群配置，不用个性化 -->
<yandex>
    <!-- 集群配置 -->
    <!-- clickhouse_remote_servers所有实例配置都一样 -->
    <!-- 集群配置 -->
      <clickhouse_remote_servers>
	    <!-- cluster_3s_1r:集群名称 -->
        <cluster_3s_1r>
            <shard>
				<!-- 开启内部数据复制 -->
                <internal_replication>true</internal_replication>
                <replica>
                    <host>server01</host>
                    <port>9000</port>
                    <user>default</user>
                    <password>123456</password>
                </replica>
                <replica>
                    <host>server02</host>
                    <port>9001</port>
                    <user>default</user>
                    <password>123456</password>
                </replica>
            </shard>

            <!-- 数据分片2  -->
            <shard>
                <internal_replication>true</internal_replication>
                <replica>
                    <host>server02</host>
                    <port>9001</port>
                    <user>default</user>
                    <password>123456</password>
                </replica>
                <replica>
                    <host>server03</host>
                    <port>9002</port>
                    <user>default</user>
                    <password>123456</password>
                </replica>
            </shard>

            <!-- 数据分片3  -->
            <shard>
                <internal_replication>true</internal_replication>
                <replica>
                    <host>server03</host>
                    <port>9002</port>
                    <user>default</user>
                    <password>123456</password>
                </replica>
                <replica>
                    <host>server01</host>
                    <port>9000</port>
                    <user>default</user>
                    <password>123456</password>
                </replica>
            </shard>
        </cluster_3s_1r>
    </clickhouse_remote_servers>

    <!-- ZK  -->
    <!-- zookeeper_servers所有实例配置都一样, 这里zookeeper根据你自己情况更改-->
    <zookeeper-servers>
        <node index="1">
            <host>192.168.3.5</host>
            <port>2181</port>
        </node>
<!--        <node index="2">-->
<!--            <host>你zookeeper的ip</host>-->
<!--            <port>2182</port>-->
<!--        </node>-->
<!--        <node index="3">-->
<!--            <host>你zookeeper的ip</host>-->
<!--            <port>2183</port>-->
<!--        </node>-->
    </zookeeper-servers>
    
    <!-- (使用ClickHouse的ReplicatedMergeTree表同步功能我们需要做一些配置操作)marcos每个实例配置不一样 分片1, 副本1 
	replica 配置当前节点的备份同步节点信息
	shard 指定的是集群分片信息中的配置
	layer 指定我们的集群标志，或者使用cluster关键字
	-->   
    <macros>
        <layer>cluster_3s_1r</layer>
        <shard>${CH_SHARD}</shard>
        <replica>${CH_REPLICA}</replica>
    </macros>

    <networks>
        <ip>::/0</ip>
    </networks>

    <!-- 数据压缩算法  -->
    <clickhouse_compression>
        <case>
            <min_part_size>10000000000</min_part_size>
            <min_part_size_ratio>0.01</min_part_size_ratio>
            <method>lz4</method>
        </case>
    </clickhouse_compression>
</yandex>
